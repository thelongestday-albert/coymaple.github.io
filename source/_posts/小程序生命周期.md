---
title: 小程序运行过程中的各种生命周期
tags:
- 小程序
---

<!-- # 小程序里面的生命周期 -->

小程序里面的生命周期有三种：应用生命周期、页面生命周期和组件生命周期。

<!-- 在小程序的运行过程中，有一些特别重要的时间点，生命周期函数就是在某个时间点的回调。 -->

<!-- 什么是生命周期：简单地说，生命周期就是一个对象的从生到死，在小程序里面，生命周期函数就是在小程序运行过程中一些重要的时间点，像加载完成、渲染完毕等。 -->

## 应用生命周期
- onLuanch ，用户首次打开小程序触发（全局只触发一次）
- onShow ，小程序初始化完成以后或从后台态切换至前台态时触发
- onHide ，小程序从前台态切换至后台态时触发

> 前后台定义：当用户点击左上角关闭或者按了设备Home键离开微信，小程序并没有直接销毁，而是进入了后台；当再次进入微信或再次打开小程序，又会从后台进入前台。

## 页面生命周期

- onLoad(options)，监听页面加载；
- onShow，监听页面显示；
- onReady，监听页面初次渲染完成；
- onHide，监听页面隐藏；
- onUnload，监听页面卸载。

## 组件生命周期

- created 组件实例被创建时触发，可以获取data中定义的属性的值，但调用 this.setData 会默认静默失败。通常情况下，这个生命周期只应该用于给组件 this 添加一些自定义属性字段。
- attached 组件实例被挂载到页面节点树上后触发，此时可以成功调用this.setData。
- detached 组件实例被从节点树中移除或使用该组件的页面被弹出页面栈时触发。

<!-- 组件的生命周期函数可以直接定义为 Component 对象的属性，也可以定义在属性 lifetimes 中。 -->

组件的生命周期可以直接定义在 Component 构造器的第一级函数中。
自小程序基础库版本 2.2.3 起，组件的生命周期也可以在 lifetimes 字段内进行声明（这是推荐的方式，此种方式定义的生命周期函数会覆盖外围的同名函数）。


除上述生命周期以外，还有一些特殊的生命周期，他们并非与组件有很强的关联，但有时组件需要获知，以便组件内部处理。这些生命周期只能定义在 pageLifetimes 属性中。
- show 组件所在的页面被展示时执行
- hide 组件所在的页面被隐藏时执行
- resize 组件所在的页面尺寸变化时执行。

## 不同情境下生命周期函数执行顺序

首次加载小程序时：先依次执行app.js里面的两个生命周期函数 onLaunch onShow ，然后执行首页里面的生命周期函数 onLoad onShow onReady 。onLoad 中的参数 options 保存了url中的查询字符串参数。

当调用 wx.navigateTo 跳转页面时，先执行当前页面中的 onHide 函数，再执行下一个页面中的生命周期函数 onLoad onShow onReady 。

当调用 wx.navigateBack 时，执行当前页面的 onUnload 函数，接着执行上一个页面的 onShow 函数。如果 wx.navigateBack 调用页面用到了自定义组件，组件的生命周期函数 detached 会在 onUnload 之后和 onShow 之前执行。

从前台态进入后台态时，先执行当前页面中的 onHide 函数，再执行 app.js 中的 onHide。

从后台态进入前台态时，先执行 app.js 中的 onShow ，再执行 当前页面的 onShow 函数。

<!-- 在页面加载时，会先执行组件的生命周期函数，然后执行页面的生命周期函数（即先加载组件，后加载页面）。 -->
在页面加载时，会先执行组件的生命周期函数，然后执行页面的生命周期函数。

<!-- 
疑问？
	1. 应用和页面生命周期函数执行的时候，小程序渲染出来了吗？ https://developers.weixin.qq.com/miniprogram/dev/framework/quickstart/framework.html#%E6%B8%B2%E6%9F%93%E5%B1%82%E5%92%8C%E9%80%BB%E8%BE%91%E5%B1%82
   -->

